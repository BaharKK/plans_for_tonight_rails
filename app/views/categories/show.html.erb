<head>
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?"></script> 
<script type="text/javascript"> 
  var geocoder;

  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
} 
//Get the latitude and the longitude;
function successFunction(position) {
    var lat = position.coords.latitude;
    var lng = position.coords.longitude;
    codeLatLng(lat, lng)
}

function errorFunction(){
    console.log("Geocoder failed");
}

  function initialize() {
    geocoder = new google.maps.Geocoder();



  }

  function codeLatLng(lat, lng) {

    var latlng = new google.maps.LatLng(lat, lng);
    geocoder.geocode({'latLng': latlng}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        if (results[1]) {
         //using formatted address to get city name
         var address = results[0].formatted_address.split(',')
         var city = address[1]
         console.log(city)

        } else {
          console.log("No results found");
        }
      } else {
        console.log("Geocoder failed due to: " + status);
      }
    });
  }
</script> 
</head> 
<body onload="initialize()">
<div class="content">
  <div id="categories-page">
    <%= link_to "Home", events_path %>
    <%= link_to "Edit Category", edit_category_path(@category) %>

    <h1>Categories#show</h1>
    <p>Find me in app/views/categories/show.html.erb</p>



    <div class="filters">
      <label>Location:  </label>
      <select class="option-set clearfix" data-filter-group="location">
        <option value="*" data-filter-value="" class="selected">show all</option>
        <%= @category.events.pluck(:location).uniq.each do |location| %>
          <option value="#filter-location-<%= location %>" data-filter-value=".<%= location %>"> <%= location %> </option>
        <% end %>
      </select>

      <label>Happening In:  </label>
      <select class="filter option-set clearfix" data-filter-group="time">
        <option value="*" data-filter-value="" class="selected">show all</option>
        <option value="#filter-time-twodays" data-filter-value=".twodays">under 48 hrs</option>
        <option value="#filter-time-oneday" data-filter-value=".oneday">under 24 hrs</option>
        <option value="#filter-time-twelvehours" data-filter-value=".twelvehours">under 12 hrs</option>
        <option value="#filter-time-sixhours" data-filter-value=".sixhours">under 6 hrs</option>
      </select>
    </div>

    <div class="grid"> 
     <% @category.events.twodays.each do |event| %>
        <div class="element-item <%= event.location %> <%= event.tags %>" data-category="<%= event.location %>">
          <%= link_to event_path(event.id) do %>
            <%= image_tag event.image_url(:thumb) if event.image? %>
          <% end %>
            <h4>Event Title: <%= link_to event.name, event_path(event.id) %> | Location: <%= event.location %></h4>
            <h4><%= formatted_date(event.show_date) %> | <%= event.duration %> mins</h4>
        </div>
      <% end %>
    </div>
  </div>
</div>
</body>